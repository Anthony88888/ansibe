<!DOCTYPE html>
<html>
<head>
<title>chapter01-001ansible安装.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
	font-size: 14px;
	padding: 0 12px;
	line-height: 22px;
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */

.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
}
</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family:  "Meiryo", "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

</head>
<body>
<h2 id="%E7%AC%AC%E4%B8%80%E7%AB%A0-ansible-%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B7%A5%E5%85%B7">第一章 ansible 自动化运维工具</h2>
<h3 id="%E7%AC%AC%E4%B8%80%E8%8A%82-ansible-%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85">第一节 ansible 软件安装</h3>
<h4 id="111-centos76-%E7%8E%AF%E5%A2%83%E4%B8%8B-yum-%E5%AE%89%E8%A3%85-ansible-%EF%BC%88%EF%BC%89">1.1.1 CentOS7.6 环境下 yum 安装 ansible （*）</h4>
<pre class="hljs"><code><div>1. 准备一台纯新的 CentOS7.6 服务器，关闭selinux，清空防火墙规则
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># hostname </span>
ansible
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># getenforce </span>
Permissive
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># iptables -vnL</span>
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>



2. 查看当前系统中的 ansible 版本，默认情况下 yum 的扩展源中包含 ansible 2.4.2.0 版本
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># ll /etc/yum.repos.d/</span>
total 32
-rw-r--r--. 1 root root 1664 Nov 23  2018 CentOS-Base.repo
-rw-r--r--. 1 root root 1309 Nov 23  2018 CentOS-CR.repo
-rw-r--r--. 1 root root  649 Nov 23  2018 CentOS-Debuginfo.repo
-rw-r--r--. 1 root root  314 Nov 23  2018 CentOS-fasttrack.repo
-rw-r--r--. 1 root root  630 Nov 23  2018 CentOS-Media.repo
-rw-r--r--. 1 root root 1331 Nov 23  2018 CentOS-Sources.repo
-rw-r--r--. 1 root root 5701 Nov 23  2018 CentOS-Vault.repo
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># yum list "*ansible*"</span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: ftp.sjtu.edu.cn
 * extras: mirrors.tuna.tsinghua.edu.cn
 * updates: mirrors.tuna.tsinghua.edu.cn
Available Packages
ansible.noarch                                                 2.4.2.0-2.el7                                  extras
ansible-doc.noarch                                             2.4.2.0-2.el7                                  extras
centos-release-ansible26.noarch                                1-3.el7.centos                                 extras
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># yum install ansible</span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: ftp.sjtu.edu.cn
 * extras: mirrors.tuna.tsinghua.edu.cn
 * updates: mirrors.tuna.tsinghua.edu.cn
Resolving Dependencies
--&gt; Running transaction check
.
.
.省略部分 yum 安装输出信息......
.
.
Installed:
  ansible.noarch 0:2.4.2.0-2.el7                                                                                    

Dependency Installed:
  PyYAML.x86_64 0:3.10-11.el7                                        libyaml.x86_64 0:0.1.4-11.el7_0               
  python-babel.noarch 0:0.9.6-8.el7                                  python-backports.x86_64 0:1.0-8.el7           
  python-backports-ssl_match_hostname.noarch 0:3.5.0.1-1.el7         python-cffi.x86_64 0:1.6.0-5.el7              
  python-enum34.noarch 0:1.0.4-1.el7                                 python-httplib2.noarch 0:0.9.2-1.el7          
  python-idna.noarch 0:2.4-1.el7                                     python-ipaddress.noarch 0:1.0.16-2.el7        
  python-jinja2.noarch 0:2.7.2-3.el7_6                               python-markupsafe.x86_64 0:0.11-10.el7        
  python-paramiko.noarch 0:2.1.1-9.el7                               python-passlib.noarch 0:1.6.5-2.el7           
  python-ply.noarch 0:3.4-11.el7                                     python-pycparser.noarch 0:2.14-1.el7          
  python-setuptools.noarch 0:0.9.8-7.el7                             python-six.noarch 0:1.9.0-2.el7               
  python2-cryptography.x86_64 0:1.7.2-2.el7                          python2-jmespath.noarch 0:0.9.0-3.el7         
  python2-pyasn1.noarch 0:0.1.9-7.el7                                sshpass.x86_64 0:1.06-2.el7                   

Complete!
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># ansible --version</span>
ansible 2.4.2.0
  config file = /etc/ansible/ansible.cfg
  configured module search path = [u<span class="hljs-string">'/root/.ansible/plugins/modules'</span>, u<span class="hljs-string">'/usr/share/ansible/plugins/modules'</span>]
  ansible python module location = /usr/lib/python2.7/site-packages/ansible
  executable location = /usr/bin/ansible
  python version = 2.7.5 (default, Oct 30 2018, 23:45:53) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>


3. 除了 yum 的默认扩展源外 epel 源中也包含 ansible ，他的版本相对高一些，因此我们先卸载之前 yum 安装的 ansible2.4.2.0
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># yum remove ansible -y </span>
Loaded plugins: fastestmirror
Resolving Dependencies
--&gt; Running transaction check
---&gt; Package ansible.noarch 0:2.4.2.0-2.el7 will be erased
--&gt; Finished Dependency Resolution

Dependencies Resolved

====================================================================================================================
 Package                   Arch                     Version                         Repository                 Size
====================================================================================================================
Removing:
 ansible                   noarch                   2.4.2.0-2.el7                   @extras                    38 M

Transaction Summary
====================================================================================================================
Remove  1 Package

Installed size: 38 M
Downloading packages:
Running transaction check
Running transaction <span class="hljs-built_in">test</span>
Transaction <span class="hljs-built_in">test</span> succeeded
Running transaction
  Erasing    : ansible-2.4.2.0-2.el7.noarch                                                                     1/1 
  Verifying  : ansible-2.4.2.0-2.el7.noarch                                                                     1/1 

Removed:
  ansible.noarch 0:2.4.2.0-2.el7                                                                                    

Complete!
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>


安装 epel 源：
[root@ansible ~]<span class="hljs-comment"># yum install epel-release -y</span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: ftp.sjtu.edu.cn
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.tuna.tsinghua.edu.cn
 * updates: mirrors.tuna.tsinghua.edu.cn
Package epel-release-7-11.noarch already installed and latest version
Nothing to <span class="hljs-keyword">do</span>
[root@ansible ~]<span class="hljs-comment">#</span>

查看 epel 源提供的 ansible 版本
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># yum list "*ansible*"</span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: ftp.sjtu.edu.cn
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.tuna.tsinghua.edu.cn
 * updates: mirrors.tuna.tsinghua.edu.cn
Available Packages
ansible.noarch                                             2.8.1-1.el7                                        epel  
ansible-doc.noarch                                         2.8.1-1.el7                                        epel  
ansible-inventory-grapher.noarch                           2.4.4-1.el7                                        epel  
ansible-lint.noarch                                        3.5.1-1.el7                                        epel  
ansible-openstack-modules.noarch                           0-20140902git79d751a.el7                           epel  
ansible-review.noarch                                      0.13.4-1.el7                                       epel  
centos-release-ansible26.noarch                            1-3.el7.centos                                     extras
kubernetes-ansible.noarch                                  0.6.0-0.1.gitd65ebd5.el7                           epel  
python2-ansible-runner.noarch                              1.0.1-1.el7                                        epel  
python2-ansible-tower-cli.noarch                           3.3.0-2.el7                                        epel  
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>

安装 ansible 2.8.1 版本：
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># yum install ansible -y </span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: ftp.sjtu.edu.cn
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.tuna.tsinghua.edu.cn
 * updates: mirrors.tuna.tsinghua.edu.cn
Package ansible-2.8.1-1.el7.noarch already installed and latest version
Nothing to <span class="hljs-keyword">do</span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>
[root@ansible ~]<span class="hljs-comment"># ansible --version</span>
ansible 2.8.1
  config file = /etc/ansible/ansible.cfg
  configured module search path = [u<span class="hljs-string">'/root/.ansible/plugins/modules'</span>, u<span class="hljs-string">'/usr/share/ansible/plugins/modules'</span>]
  ansible python module location = /usr/lib/python2.7/site-packages/ansible
  executable location = /usr/bin/ansible
  python version = 2.7.5 (default, Oct 30 2018, 23:45:53) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>

</div></code></pre>
<h4 id="112-centos76-%E7%8E%AF%E5%A2%83%E4%B8%8B-python-pip-%E5%AE%89%E8%A3%85-ansible-%EF%BC%88%EF%BC%89">1.1.2 CentOS7.6 环境下 python pip 安装 ansible （**）</h4>
<pre class="hljs"><code><div>1. 准备一台纯新的 CentOS7.6 服务器， 关闭 selinux ，清空防火墙规则
[root@python ~]<span class="hljs-comment"># hostname</span>
python
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># getenforce </span>
Permissive
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># iptables -vnL</span>
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment">#</span>


安装 epel 源：
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># yum install epel-release -y</span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirror.bit.edu.cn
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.huaweicloud.com
 * updates: mirror.jdcloud.com
Package epel-release-7-11.noarch already installed and latest version
Nothing to <span class="hljs-keyword">do</span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment">#</span>

安装 python36 并更新 pip 版本：
[root@python ~]<span class="hljs-comment"># yum list python36</span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirror.bit.edu.cn
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.huaweicloud.com
 * updates: mirror.jdcloud.com
Installed Packages
python36.x86_64                                          3.6.8-1.el7                                           @epel
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># yum install python36 python36-pip -y</span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirror.bit.edu.cn
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.huaweicloud.com
 * updates: mirror.jdcloud.com
Package python36-3.6.8-1.el7.x86_64 already installed and latest version
Package python36-pip-8.1.2-8.el7.noarch already installed and latest version
Nothing to <span class="hljs-keyword">do</span>
[root@python ~]<span class="hljs-comment">#</span>
[root@python ~]<span class="hljs-comment">#</span>
[root@python ~]<span class="hljs-comment"># pip3 install --upgrade pip</span>
Collecting pip
  Downloading https://files.pythonhosted.org/packages/5c/e0/be401c003291b56efc55aeba6a80ab790d3d4cece2778288d65323009420/pip-19.1.1-py2.py3-none-any.whl (1.4MB)
    100% |████████████████████████████████| 1.4MB 588kB/s 
Installing collected packages: pip
  Found existing installation: pip 8.1.2
    Uninstalling pip-8.1.2:
      Successfully uninstalled pip-8.1.2
Successfully installed pip
[root@python ~]<span class="hljs-comment">#</span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># hash -r</span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># pip3 -V</span>
pip 19.1.1 from /usr/<span class="hljs-built_in">local</span>/lib/python3.6/site-packages/pip (python 3.6)
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment">#</span>
[root@python ~]<span class="hljs-comment"># pip3 install ansible</span>
Collecting ansible
  Downloading https://files.pythonhosted.org/packages/d8/b5/5c5eb96463427da7b7206ff22a3470aae374656de2317eaac41dfb69a64a/ansible-2.8.2.tar.gz (14.3MB)
     |████████████████████████████████| 14.3MB 597kB/s 
Collecting jinja2 (from ansible)
  Downloading https://files.pythonhosted.org/packages/1d/e7/fd8b501e7a6dfe492a433deb7b9d833d39ca74916fa8bc63dd1a4947a671/Jinja2-2.10.1-py2.py3-none-any.whl (124kB)
     |████████████████████████████████| 133kB 1.3MB/s 
Collecting PyYAML (from ansible)
  Downloading https://files.pythonhosted.org/packages/a3/65/837fefac7475963d1eccf4aa684c23b95aa6c1d033a2c5965ccb11e22623/PyYAML-5.1.1.tar.gz (274kB)
     |████████████████████████████████| 276kB 1.3MB/s 
Collecting cryptography (from ansible)
  Downloading https://files.pythonhosted.org/packages/97/18/c6557f63a6abde34707196fb2cad1c6dc0dbff25a200d5044922496668a4/cryptography-2.7-cp34-abi3-manylinux1_x86_64.whl (2.3MB)
     |████████████████████████████████| 2.3MB 682kB/s 
Collecting MarkupSafe&gt;=0.23 (from jinja2-&gt;ansible)
  Downloading https://files.pythonhosted.org/packages/b2/5f/23e0023be6bb885d00ffbefad2942bc51a620328ee910f64abe5a8d18dd1/MarkupSafe-1.1.1-cp36-cp36m-manylinux1_x86_64.whl
Collecting asn1crypto&gt;=0.21.0 (from cryptography-&gt;ansible)
  Downloading https://files.pythonhosted.org/packages/ea/<span class="hljs-built_in">cd</span>/35485615f45f30a510576f1a56d1e0a7ad7bd8ab5ed7cdc600ef7cd06222/asn1crypto-0.24.0-py2.py3-none-any.whl (101kB)
     |████████████████████████████████| 102kB 1.2MB/s 
Collecting cffi!=1.11.3,&gt;=1.8 (from cryptography-&gt;ansible)
  Downloading https://files.pythonhosted.org/packages/5f/bf/6aa1925384c23ffeb579e97a5569eb9abce41b6310b329352b8252cee1c3/cffi-1.12.3-cp36-cp36m-manylinux1_x86_64.whl (430kB)
     |████████████████████████████████| 440kB 1.1MB/s 
Collecting six&gt;=1.4.1 (from cryptography-&gt;ansible)
  Downloading https://files.pythonhosted.org/packages/73/fb/00a976f728d0d1fecfe898238ce23f502a721c0ac0ecfedb80e0d88c64e9/six-1.12.0-py2.py3-none-any.whl
Collecting pycparser (from cffi!=1.11.3,&gt;=1.8-&gt;cryptography-&gt;ansible)
  Downloading https://files.pythonhosted.org/packages/68/9e/49196946aee219aead1290e00d1e7fdeab8567783e83e1b9ab5585e6206a/pycparser-2.19.tar.gz (158kB)
     |████████████████████████████████| 163kB 1.1MB/s 
Installing collected packages: MarkupSafe, jinja2, PyYAML, asn1crypto, pycparser, cffi, six, cryptography, ansible
  Running setup.py install <span class="hljs-keyword">for</span> PyYAML ... <span class="hljs-keyword">done</span>
  Running setup.py install <span class="hljs-keyword">for</span> pycparser ... <span class="hljs-keyword">done</span>
  Running setup.py install <span class="hljs-keyword">for</span> ansible ... <span class="hljs-keyword">done</span>
Successfully installed MarkupSafe-1.1.1 PyYAML-5.1.1 ansible-2.8.2 asn1crypto-0.24.0 cffi-1.12.3 cryptography-2.7 jinja2-2.10.1 pycparser-2.19 six-1.12.0
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment">#</span>
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># ansible --version</span>
ansible 2.8.2
  config file = None
  configured module search path = [<span class="hljs-string">'/root/.ansible/plugins/modules'</span>, <span class="hljs-string">'/usr/share/ansible/plugins/modules'</span>]
  ansible python module location = /usr/<span class="hljs-built_in">local</span>/lib/python3.6/site-packages/ansible
  executable location = /usr/<span class="hljs-built_in">local</span>/bin/ansible
  python version = 3.6.8 (default, Apr 25 2019, 21:02:35) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]
[root@python ~]<span class="hljs-comment"># </span>
[root@python ~]<span class="hljs-comment"># </span>
</div></code></pre>
<h4 id="113-centos76-%E7%8E%AF%E5%A2%83%E4%B8%8B%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85-ansible282-%E7%89%88%E6%9C%AC-%EF%BC%88%EF%BC%89">1.1.3 CentOS7.6 环境下源码安装 ansible2.8.2 版本 （***）</h4>
<pre class="hljs"><code><div>1. 准备一台纯新的 CentOS7.6 服务器，关闭 selinux， 清空防火墙
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># hostname</span>
ansible
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># getenforce </span>
Permissive
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># iptables -vnL</span>
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt <span class="hljs-keyword">in</span>     out     <span class="hljs-built_in">source</span>               destination         
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>


2. 安装 wget 命令，下载 ansible 源代码
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># yum install epel-release wget -y </span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirror.bit.edu.cn
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.tuna.tsinghua.edu.cn
 * updates: mirrors.tuna.tsinghua.edu.cn
Package epel-release-7-11.noarch already installed and latest version
Package wget-1.14-18.el7_6.1.x86_64 already installed and latest version
Nothing to <span class="hljs-keyword">do</span>
[root@ansible ~]<span class="hljs-comment">#</span>
[root@ansible ~]<span class="hljs-comment"># yum install python2-pip  -y </span>
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.huaweicloud.com
 * epel: mirrors.tuna.tsinghua.edu.cn
 * extras: mirrors.tuna.tsinghua.edu.cn
 * updates: mirrors.huaweicloud.com
Package python2-pip-8.1.2-8.el7.noarch already installed and latest version
Nothing to <span class="hljs-keyword">do</span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># pip install --upgrade pip</span>
Collecting pip
  Downloading https://files.pythonhosted.org/packages/5c/e0/be401c003291b56efc55aeba6a80ab790d3d4cece2778288d65323009420/pip-19.1.1-py2.py3-none-any.whl (1.4MB)
    100% |████████████████████████████████| 1.4MB 377kB/s 
Installing collected packages: pip
  Found existing installation: pip 8.1.2
    Uninstalling pip-8.1.2:
      Successfully uninstalled pip-8.1.2
Successfully installed pip-19.1.1
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># pip install --upgrade setuptools</span>
DEPRECATION: Python 2.7 will reach the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 won not be maintained after that date. A future version of pip will drop support <span class="hljs-keyword">for</span> Python 2.7.
Collecting setuptools
  Downloading https://files.pythonhosted.org/packages/ec/51/f45cea425fd5cb0b0380f5b0f048ebc1da5b417e48d304838c02d6288a1e/setuptools-41.0.1-py2.py3-none-any.whl (575kB)
     |████████████████████████████████| 583kB 342kB/s 
Installing collected packages: setuptools
  Found existing installation: setuptools 0.9.8
    Uninstalling setuptools-0.9.8:
      Successfully uninstalled setuptools-0.9.8
Successfully installed setuptools-41.0.1
[root@ansible ~]<span class="hljs-comment">#</span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># wget https://github.com/ansible/ansible/archive/v2.8.2.tar.gz</span>
--2019-07-17 14:24:28--  https://github.com/ansible/ansible/archive/v2.8.2.tar.gz
Resolving github.com (github.com)... 13.229.188.59
Connecting to github.com (github.com)|13.229.188.59|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://codeload.github.com/ansible/ansible/tar.gz/v2.8.2 [following]
--2019-07-17 14:24:30--  https://codeload.github.com/ansible/ansible/tar.gz/v2.8.2
Resolving codeload.github.com (codeload.github.com)... 13.229.189.0
Connecting to codeload.github.com (codeload.github.com)|13.229.189.0|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [application/x-gzip]
Saving to: ‘v2.8.2.tar.gz’

    [                                          &lt;=&gt;                              ] 14,623,914   243KB/s   <span class="hljs-keyword">in</span> 53s    

2019-07-17 14:25:24 (268 KB/s) - ‘v2.8.2.tar.gz’ saved [14623914]

[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>
[root@ansible ~]<span class="hljs-comment"># ll</span>
total 14288
-rw-------. 1 root root     1368 Jun 16 14:32 anaconda-ks.cfg
-rw-r--r--. 1 root root 14623914 Jul 17 14:25 v2.8.2.tar.gz
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>

3. 解压后进行 ansible 安装
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># tar xf v2.8.2.tar.gz </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># ll</span>
total 14292
-rw-------.  1 root root     1368 Jun 16 14:32 anaconda-ks.cfg
drwxrwxr-x. 11 root root     4096 Jul  4 01:36 ansible-2.8.2
-rw-r--r--.  1 root root 14623914 Jul 17 14:56 v2.8.2.tar.gz
[root@ansible ~]<span class="hljs-comment"># cd ansible-2.8.2/</span>
[root@ansible ansible-2.8.2]<span class="hljs-comment"># </span>
[root@ansible ansible-2.8.2]<span class="hljs-comment"># python setup.py build</span>
.
.省略部分 build 输出信息.....
.
copying and adjusting bin/ansible-console -&gt; build/scripts-2.7
copying and adjusting bin/ansible-connection -&gt; build/scripts-2.7
copying and adjusting bin/ansible-vault -&gt; build/scripts-2.7
copying and adjusting bin/ansible-config -&gt; build/scripts-2.7
copying and adjusting bin/ansible-inventory -&gt; build/scripts-2.7
changing mode of build/scripts-2.7/ansible from 644 to 755
changing mode of build/scripts-2.7/ansible-playbook from 644 to 755
changing mode of build/scripts-2.7/ansible-pull from 644 to 755
changing mode of build/scripts-2.7/ansible-doc from 644 to 755
changing mode of build/scripts-2.7/ansible-galaxy from 644 to 755
changing mode of build/scripts-2.7/ansible-console from 644 to 755
changing mode of build/scripts-2.7/ansible-connection from 644 to 755
changing mode of build/scripts-2.7/ansible-vault from 644 to 755
changing mode of build/scripts-2.7/ansible-config from 644 to 755
changing mode of build/scripts-2.7/ansible-inventory from 644 to 755
[root@ansible ansible-2.8.2]<span class="hljs-comment">#</span>
[root@ansible ansible-2.8.2]<span class="hljs-comment">#</span>
[root@ansible ansible-2.8.2]<span class="hljs-comment">#</span>
[root@ansible ansible-2.8.2]<span class="hljs-comment"># python setup.py install</span>
.
.省略部分安装输出信息....
.
Best match: MarkupSafe 1.1.1
Processing MarkupSafe-1.1.1-cp27-cp27mu-manylinux1_x86_64.whl
Installing MarkupSafe-1.1.1-cp27-cp27mu-manylinux1_x86_64.whl to /usr/lib/python2.7/site-packages
Adding MarkupSafe 1.1.1 to easy-install.pth file

Installed /usr/lib/python2.7/site-packages/MarkupSafe-1.1.1-py2.7-linux-x86_64.egg
Searching <span class="hljs-keyword">for</span> pycparser
Reading https://pypi.org/simple/pycparser/
Downloading https://files.pythonhosted.org/packages/68/9e/49196946aee219aead1290e00d1e7fdeab8567783e83e1b9ab5585e6206a/pycparser-2.19.tar.gz<span class="hljs-comment">#sha256=a988718abfad80b6b157acce7bf130a30876d27603738ac39f140993246b25b3</span>
Best match: pycparser 2.19
Processing pycparser-2.19.tar.gz
Writing /tmp/easy_install-fNU2hF/pycparser-2.19/setup.cfg
Running pycparser-2.19/setup.py -q bdist_egg --dist-dir /tmp/easy_install-fNU2hF/pycparser-2.19/egg-dist-tmp-7WRAO2
warning: no previously-included files found matching <span class="hljs-string">'setup.pyc'</span>
warning: no previously-included files matching <span class="hljs-string">'yacctab.*'</span> found under directory <span class="hljs-string">'tests'</span>
warning: no previously-included files matching <span class="hljs-string">'lextab.*'</span> found under directory <span class="hljs-string">'tests'</span>
warning: no previously-included files matching <span class="hljs-string">'yacctab.*'</span> found under directory <span class="hljs-string">'examples'</span>
warning: no previously-included files matching <span class="hljs-string">'lextab.*'</span> found under directory <span class="hljs-string">'examples'</span>
zip_safe flag not <span class="hljs-built_in">set</span>; analyzing archive contents...
pycparser.ply.lex: module references __file__
pycparser.ply.lex: module MAY be using inspect.getsourcefile
pycparser.ply.yacc: module references __file__
pycparser.ply.yacc: module MAY be using inspect.getsourcefile
pycparser.ply.yacc: module MAY be using inspect.stack
pycparser.ply.ygen: module references __file__
creating /usr/lib/python2.7/site-packages/pycparser-2.19-py2.7.egg
Extracting pycparser-2.19-py2.7.egg to /usr/lib/python2.7/site-packages
Adding pycparser 2.19 to easy-install.pth file

Installed /usr/lib/python2.7/site-packages/pycparser-2.19-py2.7.egg
Searching <span class="hljs-keyword">for</span> ipaddress==1.0.16
Best match: ipaddress 1.0.16
Adding ipaddress 1.0.16 to easy-install.pth file

Using /usr/lib/python2.7/site-packages
Finished processing dependencies <span class="hljs-keyword">for</span> ansible==2.8.2
[root@ansible ansible-2.8.2]<span class="hljs-comment"># </span>
[root@ansible ansible-2.8.2]<span class="hljs-comment"># </span>
[root@ansible ansible-2.8.2]<span class="hljs-comment">#</span>
[root@ansible ansible-2.8.2]<span class="hljs-comment"># cd</span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># ll</span>
total 14292
-rw-------.  1 root root     1368 Jun 16 14:32 anaconda-ks.cfg
drwxrwxr-x. 13 root root     4096 Jul 17 15:03 ansible-2.8.2
-rw-r--r--.  1 root root 14623914 Jul 17 14:56 v2.8.2.tar.gz
[root@ansible ~]
[root@ansible ~]<span class="hljs-comment">#</span>
[root@ansible ~]<span class="hljs-comment">#</span>
[root@ansible ~]<span class="hljs-comment"># rm -rf ansible-2.8.2</span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># rm -rf v2.8.2.tar.gz </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># ll</span>
total 4
-rw-------. 1 root root 1368 Jun 16 14:32 anaconda-ks.cfg
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># ll /usr/lib/python2.7/site-packages/</span>
total 808
drwxr-xr-x.  4 root root     37 Jul 17 15:06 ansible-2.8.2-py2.7.egg
drwxr-xr-x.  4 root root     40 Jul 17 15:04 asn1crypto-0.24.0-py2.7.egg
drwxr-xr-x.  3 root root     91 Jul 17 14:52 backports
-rw-r--r--.  1 root root   4051 Apr 11  2018 backports.ssl_match_hostname-3.5.0.1-py2.7.egg-info
drwxr-xr-x.  5 root root     84 Jul 17 15:04 cffi-1.12.3-py2.7-linux-x86_64.egg
-rw-r--r--.  1 root root   2135 Jun 10  2014 configobj-4.7.2-py2.7.egg-info
-rw-r--r--.  1 root root  88163 Feb 28  2010 configobj.py
-rw-r--r--.  2 root root  66278 Jun 10  2014 configobj.pyc
-rw-r--r--.  2 root root  66278 Jun 10  2014 configobj.pyo
drwxr-xr-x.  4 root root     42 Jul 17 15:03 cryptography-2.7-py2.7-linux-x86_64.egg
drwxr-xr-x.  2 root root    110 Jun 16 14:27 decorator-3.4.0-py2.7.egg-info
-rw-r--r--.  1 root root  10639 Oct 18  2012 decorator.py
-rw-r--r--.  1 root root   8563 Jun 10  2014 decorator.pyc
-rw-r--r--.  1 root root   8516 Jun 10  2014 decorator.pyo
-rw-r--r--.  1 root root    316 Jul 17 15:06 easy-install.pth
-rw-r--r--.  1 root root    126 Jul 17 14:59 easy_install.py
-rw-r--r--.  1 root root    317 Jul 17 14:59 easy_install.pyc
drwxr-xr-x.  4 root root     34 Jul 17 15:03 enum34-1.1.6-py2.7.egg
drwxr-xr-x.  5 root root   4096 Jun 16 14:27 firewall
drwxr-xr-x.  2 root root    265 Jun 16 14:27 iniparse
-rw-r--r--.  1 root root   1083 Jun 10  2014 iniparse-0.4-py2.7.egg-info
-rw-r--r--.  1 root root    783 Nov  6  2016 ipaddress-1.0.16-py2.7.egg-info
-rw-r--r--.  1 root root  79904 Dec 29  2015 ipaddress.py
-rw-r--r--.  1 root root  75525 Nov  6  2016 ipaddress.pyc
-rw-r--r--.  1 root root  75335 Nov  6  2016 ipaddress.pyo
drwxr-xr-x.  4 root root     36 Jul 17 15:03 Jinja2-2.10.1-py2.7.egg
drwxr-xr-x.  4 root root     40 Jul 17 15:04 MarkupSafe-1.1.1-py2.7-linux-x86_64.egg
drwxr-xr-x.  4 root root    116 Jul 17 14:52 pip
drwxr-xr-x.  2 root root    130 Jul 17 14:52 pip-19.1.1.dist-info
drwxr-xr-x.  4 root root    117 Jul 17 14:59 pkg_resources
drwxr-xr-x.  2 root root    227 Jun 16 14:27 procfs
drwxr-xr-x.  4 root root     39 Jul 17 15:04 pycparser-2.19-py2.7.egg
-rw-r--r--.  1 root root    350 Oct 31  2018 python_linux_procfs-0.4.9-py2.7.egg-info
drwxr-xr-x.  2 root root   4096 Jun 16 14:27 pyudev
drwxr-xr-x.  2 root root     90 Jun 16 14:27 pyudev-0.15-py2.7.egg-info
-rw-r--r--.  1 root root 101477 Jul 17 15:03 PyYAML-5.1.1-py2.7-linux-x86_64.egg
drwxr-xr-x.  2 root root    238 Jun 16 14:27 rpmUtils
drwxr-xr-x.  5 root root   4096 Jul 17 14:59 setuptools
drwxr-xr-x.  2 root root    170 Jul 17 14:59 setuptools-41.0.1.dist-info
drwxr-xr-x.  3 root root     36 Jul 17 15:03 six-1.12.0-py2.7.egg
drwxr-xr-x.  5 root root    106 Jun 16 14:27 slip
-rw-r--r--.  1 root root    196 Apr 11  2018 slip-0.4.0-py2.7.egg-info
-rw-r--r--.  1 root root    269 Apr 11  2018 slip.dbus-0.4.0-py2.7.egg-info
drwxr-xr-x. 12 root root   4096 Jun 16 14:28 tuned
drwxr-xr-x.  2 root root   4096 Jun 16 14:27 urlgrabber
-rw-r--r--.  1 root root   2265 Oct 31  2018 urlgrabber-3.10-py2.7.egg-info
-rw-r--r--.  1 root root  46303 Jun 10  2014 validate.py
-rw-r--r--.  2 root root  46711 Jun 10  2014 validate.pyc
-rw-r--r--.  2 root root  46711 Jun 10  2014 validate.pyo
drwxr-xr-x.  2 root root   4096 Jun 16 14:27 yum
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment"># ansible --version</span>
ansible 2.8.2
  config file = None
  configured module search path = [u<span class="hljs-string">'/root/.ansible/plugins/modules'</span>, u<span class="hljs-string">'/usr/share/ansible/plugins/modules'</span>]
  ansible python module location = /usr/lib/python2.7/site-packages/ansible-2.8.2-py2.7.egg/ansible
  executable location = /usr/bin/ansible
  python version = 2.7.5 (default, Oct 30 2018, 23:45:53) [GCC 4.8.5 20150623 (Red Hat 4.8.5-36)]
[root@ansible ~]<span class="hljs-comment"># </span>
[root@ansible ~]<span class="hljs-comment">#</span>
</div></code></pre>

</body>
</html>
